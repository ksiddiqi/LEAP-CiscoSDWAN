
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Cisco SD-WAN Lab">
      
      
        <meta name="author" content="CX Team">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.7">
    
    
      
        <title>Task 6 Hub & Spoke Topology - LEAP 2022 - Cisco SD-WAN Lab</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.cd566b2a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#task-8-creating-hub-and-spoke-topoloy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LEAP 2022 - Cisco SD-WAN Lab" class="md-header__button md-logo" aria-label="LEAP 2022 - Cisco SD-WAN Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LEAP 2022 - Cisco SD-WAN Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Task 6 Hub & Spoke Topology
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LEAP 2022 - Cisco SD-WAN Lab" class="md-nav__button md-logo" aria-label="LEAP 2022 - Cisco SD-WAN Lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LEAP 2022 - Cisco SD-WAN Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Topology/" class="md-nav__link">
        Topology
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Task1-Connect/" class="md-nav__link">
        Task 1 Remote Connection
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Task2-Exploring%20Control%20Plane/" class="md-nav__link">
        Task 2 Control Plane
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Task3-vEdge/" class="md-nav__link">
        Task 3 vEdge on internal networks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Task4-Full-Mesh/" class="md-nav__link">
        Task 4 Full-Mesh Data Plane on internal networks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Task5-VPN%20creations/" class="md-nav__link">
        Task 5 Establish VPN connectivity on Fabric
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Task 6 Hub & Spoke Topology
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Task 6 Hub & Spoke Topology
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-verify-vedge-routes-for-vpn10-vpn20-and-vpn30" class="md-nav__link">
    Step 1: Verify vEdge routes for VPN10, VPN20 and VPN30
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-configure-policy-on-vmanage-to-create-hub-and-spoke-topology" class="md-nav__link">
    Step 2: Configure Policy on vManage to create Hub and Spoke Topology
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-verify-vedge-routes-for-vpn10-vpn20-and-vpn30" class="md-nav__link">
    Step 1: Verify vEdge routes for VPN10, VPN20 and VPN30
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-configure-policy-on-vmanage-to-create-hub-and-spoke-topology" class="md-nav__link">
    Step 2: Configure Policy on vManage to create Hub and Spoke Topology
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="task-8-creating-hub-and-spoke-topoloy">Task 8 - Creating Hub and Spoke Topoloy</h1>
<p>This task will walk you through the steps to create Hub and Spoke topology for all branches. Where Data Center vEdge will be Hub and the 2 Branches will be spokes.</p>
<h2 id="step-1-verify-vedge-routes-for-vpn10-vpn20-and-vpn30">Step 1: Verify vEdge routes for VPN10, VPN20 and VPN30</h2>
<p>In this step we will SSH to the vEdge in Branch1 and Branch2 and verify routing table showing all connectios are fully mesh.</p>
<ul>
<li>
<p>Launch <strong>Mputty</strong> application from the Remote desktop by clicking on it's icon on the desktop:</p>
<p><img alt="Mputty" src="../pics/t3-mputty.png" /></p>
</li>
<li>
<p>Using <strong>MPutty</strong> on your Remote Desktop session, initiate a <strong>SSH</strong> session to the BR1-vEdge with <strong>IP address</strong> of <strong>198.18.134.105</strong> this vEdge (<strong>BR1-vEdge</strong>).  You can use credentials of <code>admin</code> and <code>admin</code> for  authentication.</p>
<ul>
<li>If prompted for "Putty Security Alert" then Trust the host by clicking "Yes" on dialog box.  </li>
<li>The <strong>SSH credentials</strong> (username and password) are <code>admin</code> and <code>admin</code> respectively</li>
</ul>
<table>
<thead>
<tr>
<th><strong>Note:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>If <code>admin/admin</code> credentials do not work then you may try using <code>cisco/cisco</code> or <code>cisco1/cisco1</code></td>
</tr>
</tbody>
</table>
</li>
<li>
<p>On the <strong>SSH</strong> connection, <strong>execute</strong> the below <strong>command</strong> to view configuration of VPN 20 on BR1-vEdge: </p>
</li>
</ul>
<pre><code>show run vpn 20
</code></pre>
<p>Below screenshot shows VPN 20 configs:</p>
<p><img alt="" src="../pics/t8a-show%20run%20vpn%2020-BR1.png" /></p>
<p>Below screenshot BR2-vEdge for VPN20:</p>
<p><img alt="" src="../pics/t8a-show%20run%20vpn%2020-BR2.png" /></p>
<ul>
<li><strong>Execute</strong> below <strong>command</strong> to verify the routing table for VPN 20 on both vEdge: </li>
</ul>
<pre><code>show ip route vpn 20
</code></pre>
<p><img alt="VPN 512" src="../pics/t8a-show%20ip%20route%20vpn%2020-br1.png" /></p>
<p>As shown in the output in the below screenshot, prefix 10.20.2.1/32 (BR2 VPN 20 Loopback20) is directly received from  TLOC IP 10.4.0.1 (BR2-TlOC) from both links (MPLS and Private1).</p>
<p>Also prefix 10.20.100.1/32 (DC-vEdge loopback20) is directly received from TLOC IP 10.1.0.1 (DC-vEdge) from both links (MPLS and Private1).</p>
<ul>
<li>Lets look at the screenshots from BR2 which shows that all prefixes are directly received from respective vEdges.</li>
</ul>
<p><img alt="" src="../pics/t8a-show%20ip%20route%20vpn20-BR2.png" /></p>
<p>Below is the output for DC-vEDGE</p>
<p><img alt="" src="../pics/t8a-show%20ip%20route%20vpn20-DC.png" /></p>
<table>
<thead>
<tr>
<th><strong>Note:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>You will notice that there no routes coming in from AWS-vEdges. This is because TLOCs are unreachable between branches and AWS. We will fix this towards the end of the this task.</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Let's verify the same using <strong>vManage</strong></p>
<ul>
<li>Open Chrome Browser from Workstation and click Viptela Vmanage from Bookmark Toolbar</li>
</ul>
</li>
</ul>
<p><img alt="VPN 512" src="../pics/t8a-Open%20Vitpela.png" /></p>
<p>At the login page enter user/pass: admin/admin and login.</p>
<p><img alt="" src="../pics/t8a-vManage%20login.png" /></p>
<p>Verify the traffic path using <strong>vManage</strong>. Open <strong>vManage</strong> select <strong>Monitoring&gt;Network</strong></p>
<p><img alt="" src="../pics/t8a-Trace-verify1.png" /></p>
<ul>
<li>Select <strong>BR1-vEdge</strong></li>
</ul>
<p><img alt="" src="../pics/t8a-Trace-verify2.png" /></p>
<ul>
<li>Select <strong>Troubleshooting</strong> </li>
</ul>
<p><img alt="" src="../pics/t8a-Trace-verify3.png" /></p>
<ul>
<li>Select <strong>Trace Route</strong> </li>
</ul>
<p><img alt="" src="../pics/t8a-Trace-verify4.png" /></p>
<ul>
<li>Enter <strong>Destination IP</strong><em>, select </em><em>VPN-20</em><em> and click </em><em>Start</em>*</li>
</ul>
<p><img alt="" src="../pics/t8a-Trace-verify5.png" /></p>
<p>You can verify that the traffic is going directly to BR2-vEdge</p>
<p><img alt="" src="../pics/t8a-Trace-verify8.png" /></p>
<p>Follow the same steps and verify <strong>BR2-vEdge</strong> traffic path for <strong>VPN-20</strong> towards <strong>BR1-vEdge</strong>. You will observe the below output.</p>
<p><img alt="" src="../pics/t8a-Trace-verify9.png" /></p>
<table>
<thead>
<tr>
<th><strong>Note:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Follow the same steps to verify VPN10 and VPN30</td>
</tr>
</tbody>
</table>
<h2 id="step-2-configure-policy-on-vmanage-to-create-hub-and-spoke-topology">Step 2: Configure Policy on vManage to create Hub and Spoke Topology</h2>
<ul>
<li>
<p>Configure Hub and Spoke policy from vManage.</p>
<p>First we will create Site list, VPN list and TLOC list which will be referred by the policy in the later steps</p>
<ul>
<li>Click <strong>Configuration&gt;Template</strong></li>
</ul>
<p><img alt="" src="../pics/t8a-Configuration-Policy.png" /></p>
<ul>
<li>Click <strong>Add Policy</strong></li>
</ul>
<p><img alt="" src="../pics/t8a-Add-Policy.png" /></p>
<ul>
<li>Select <strong>Site</strong> and click <strong>New Site List</strong>, enter the details as per below table and click <strong>Add</strong>.</li>
</ul>
<p>Fill in Site details as per table below</p>
<table>
<thead>
<tr>
<th>Site Name</th>
<th>Site Number</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data-Center</td>
<td>100</td>
</tr>
<tr>
<td>Branch1</td>
<td>101</td>
</tr>
<tr>
<td>Branch2</td>
<td>102</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>Note:</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>You have to add each site seperately.</td>
</tr>
</tbody>
</table>
<p><img alt="" src="../pics/t8a-Add-Site-list.png" /></p>
<ul>
<li>Now Select <strong>TLOC</strong>, click <strong>New TLOC List</strong>, enter the details as per below table then click <strong>Add</strong>.</li>
</ul>
<p><img alt="" src="../pics/t8a-Add-TLOC-list.png" /></p>
<p>Fill in TLOC details as per table below</p>
<table>
<thead>
<tr>
<th>Site Name</th>
<th>TLOC</th>
<th>Color</th>
<th>Encap</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data-Center</td>
<td>172.16.101.1</td>
<td>private1</td>
<td>ipsec</td>
</tr>
<tr>
<td>Data-Center</td>
<td>172.16.101.1</td>
<td>mpls</td>
<td>ipsec</td>
</tr>
<tr>
<td>Branch1</td>
<td>172.16.102.1</td>
<td>private1</td>
<td>ipsec</td>
</tr>
<tr>
<td>Branch1</td>
<td>172.16.102.1</td>
<td>mpls</td>
<td>ipsec</td>
</tr>
<tr>
<td>Branch2</td>
<td>172.16.103.1</td>
<td>private1</td>
<td>ipsec</td>
</tr>
<tr>
<td>Branch2</td>
<td>172.16.103.1</td>
<td>mpls</td>
<td>ipsec</td>
</tr>
</tbody>
</table>
<p>Enter Data-Center TLOC values for color <strong>mpls</strong> and click <strong>Add TLOC</strong></p>
<p><img alt="" src="../pics/t8a-Add-DC-TLOC-1.png" /></p>
<p>Enter Data-Center TLOC values for color <strong>private1</strong> and click <strong>Save</strong></p>
<p><img alt="" src="../pics/t8a-Add-DC-TLOC-2.png" /></p>
<p>Repeat the same step for Branch 1 &amp; 2 </p>
<ul>
<li>For adding VPN List Select <strong>VPN</strong>, click <strong>New VPN List</strong>, enter the details as per below table then click <strong>Add</strong>.</li>
</ul>
<table>
<thead>
<tr>
<th>VPN Name</th>
<th>VPN Number</th>
</tr>
</thead>
<tbody>
<tr>
<td>BusinessVPN</td>
<td>20</td>
</tr>
<tr>
<td>AppVPN</td>
<td>10</td>
</tr>
<tr>
<td>Marketing</td>
<td>30</td>
</tr>
</tbody>
</table>
<p><img alt="" src="../pics/t8a-Add-VPN-list1.png" /></p>
<p>Repeat the same task for AppVPN and Marketing. Once the task is complete, below is how the VPN list looks like.</p>
<p><img alt="" src="../pics/t8a-VPN-list.png" /></p>
</li>
<li>
<p>Click <strong>Next</strong>, below page will open. Click <strong>Add Topology</strong> then click <strong>Custom Control (Route &amp; TLOC)</strong></p>
<p><img alt="" src="../pics/t8a-Add-topology.png" /></p>
<p>Below page will open, on the Middle-Right corner, click <strong>pencil</strong> icon</p>
<p><img alt="" src="../pics/t8a-topology-default-action1.png" /></p>
</li>
</ul>
<p>Change the <strong>Default Action</strong> from <strong>Reject</strong> to <strong>Accept</strong>, then click <strong>Save Match And Action</strong></p>
<p><img alt="" src="../pics/t8a-topology-default-action2.png" /></p>
<p>Verify <strong>Default Action</strong> is changed to <strong>Accept</strong> </p>
<p><img alt="" src="../pics/t8a-topology-default-action3.png" /></p>
<ul>
<li>
<p>Enter <strong>Name</strong> and <strong>Description</strong> and click <strong>Sequence Type</strong></p>
<ul>
<li><strong>Name</strong>: <code>Hub-Spoke</code></li>
<li><strong>Description</strong>: <code>Hub and Spoke Topology</code></li>
</ul>
<p><img alt="" src="../pics/t8a-Seuqence-Rule1.png" /></p>
<p>Click <strong>Route</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Rule2.png" /></p>
</li>
<li>
<p>Click <strong>Sequence Rule</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type1.png" /></p>
</li>
</ul>
<p>Click <strong>Site</strong> and under <strong>Site list</strong> Select <strong>CL-Branch1</strong>, then click <strong>Action</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type4.png" /></p>
<p>Select <strong>Accept</strong> then click <strong>TLOC</strong>. Under <strong>TLOC List</strong> enter <strong>Date-Center</strong> then click <strong>Save Match And Actions</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type6.png" /></p>
<p>Repeat the same steps for Branch2 and once complete  Click <strong>Save Control Policy</strong> located at the bottom of the page</p>
<p>Click <strong>Save Control Policy</strong></p>
<p><img alt="" src="../pics/t8a-Save-Policy.png" /></p>
<ul>
<li>
<p>Click <strong>Next</strong>, below screen will appear.</p>
<p><img alt="" src="../pics/t8a-Seuqence-Type9.png" /></p>
</li>
<li>
<p>Click <strong>Next</strong> again on <strong>Application Aware Routing</strong> Screen</p>
<p><img alt="" src="../pics/t8a-Seuqence-Type10.png" /></p>
</li>
<li>
<p>Enter <strong>Policy Name</strong> and <strong>Description</strong> then click <strong>New Site List</strong> </p>
<ul>
<li><strong>Name</strong>: <code>Hub-Spoke</code></li>
<li><strong>Description</strong>: <code>Hub and Spoke Policy</code></li>
</ul>
<p><img alt="" src="../pics/t8a-Seuqence-Type11.png" /></p>
<p>On <strong>Outbound Site List</strong> select <strong>CL-Branch1</strong>, <strong>Cl-Branch2</strong> ignore <strong>AWS</strong> as shown in the picture</p>
<p><img alt="" src="../pics/t8a-Seuqence-Type12.png" /></p>
<p>Click <strong>Add</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type13.png" />   </p>
<p>Click <strong>Save Policy</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type14.png" /></p>
</li>
<li>
<p>The Hub and Spoke policy is created, verify policy clicking <strong>"..."</strong> on the right side and select <strong>Preview</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type15.png" /></p>
<p>Below is the snapshot, what will be configured as part of the <strong>Hub and Spoke Policy</strong>  </p>
</li>
</ul>
<pre><code>policy
control-policy Hub-Spoke
sequence 1
 match route
  site-list Branch2
 !
 action accept
  set
   tloc-list Data-Center
  !
 !
!
sequence 11
 match route
  site-list Branch1
 !
 action accept
  set
   tloc-list Data-Center
  !
 !
!
default-action accept
!
!
site-list AllBranches
site-id 300-499 
!
site-list Branch1
site-id 300 
!
site-list Branch2
site-id 400 
!
tloc-list Data-Center
tloc 10.1.0.1 color mpls encap ipsec 
tloc 10.1.0.1 color private1 encap ipsec 
!
!
!
site-list Branch1
control-policy Hub-Spoke out
!
site-list Branch2
control-policy Hub-Spoke out
!
!
</code></pre>
<ul>
<li>
<p>Click <strong>OK</strong>, then activate the policy clicking <strong>"..."</strong> on the right side and select <strong>Activate</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type15b.png" /></p>
</li>
<li>
<p>Click <strong>Activate</strong> again</p>
<p><img alt="" src="../pics/t8a-Seuqence-Type17.png" /></p>
<p>The process will start and you can track the status from the <strong>Status Bar</strong>, once the task is sucessfully complete. You will <strong>Status</strong> as <strong>Sucess</strong></p>
<p><img alt="" src="../pics/t8a-Seuqence-Type18.png" /></p>
<p>Below is the output once the task is sucessfully completed.</p>
<p><img alt="" src="../pics/t8a-Seuqence-Type19.png" /></p>
</li>
<li>
<p>Verify the policy. Launch <strong>Mputty</strong> application from the Remote desktop and login to BR1-vEdge and run the following command</p>
<pre><code>show ip route vpn 20
</code></pre>
</li>
</ul>
<p>You can notice that the prefix 10.20.2.1/32 (BR2 VPN 20 Loopback20) is now received from  TLOC IP 10.1.0.1 (DC-TlOC) from both links (MPLS and Private1).</p>
<p><img alt="" src="../pics/t8a-Route-Verify-BR1.png" /></p>
<p>Verify the same from BR2 and you see prefixes are received from DC.</p>
<p><img alt="" src="../pics/t8a-Route-Verify-BR2.png" /></p>
<ul>
<li>
<p>Verify the traffic path using <strong>vManage</strong>. Open <strong>vManage</strong> select <strong>Monitoring&gt;Network</strong></p>
<p><img alt="" src="../pics/t8a-Trace-verify1.png" /></p>
<p>Select <strong>BR1-vEdge</strong></p>
<p><img alt="" src="../pics/t8a-Trace-verify2.png" /></p>
<p>Select <strong>Troubleshooting</strong> </p>
<p><img alt="" src="../pics/t8a-Trace-verify3.png" /></p>
<p>Select <strong>Trace Route</strong> </p>
<p><img alt="" src="../pics/t8a-Trace-verify4.png" /></p>
<p>Enter <strong>Destination IP</strong><em>, select </em><em>VPN-20</em><em> and click </em><em>Start</em>*</p>
<p><img alt="" src="../pics/t8a-Trace-verify5.png" /></p>
<p>You can observe that the traffic is now going via <strong>DC-vEdge</strong>  Loopback IP <strong>10.200.100.1</strong> towards <strong>BR2-vEdge</strong>.</p>
<p><img alt="" src="../pics/t8a-Trace-verify6.png" /></p>
<p>Now Verify <strong>BR2-vEdge</strong> traffic path for <strong>VPN-20</strong> towards <strong>BR1-vEdge</strong>. You will observe the below output.</p>
<p><img alt="" src="../pics/t8a-Trace-verify7.png" /></p>
<p>Verify connectivity between all Branches on all VPNs (10, 20, 30)</p>
</li>
</ul>
<hr />
<p>Congratulations, you have completed the and you are now an expert on Cisco SD-WAN technologies.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Task5-VPN%20creations/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Task 5 Establish VPN connectivity on Fabric" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Task 5 Establish VPN connectivity on Fabric
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.01de222e.min.js"></script>
      
    
  </body>
</html>